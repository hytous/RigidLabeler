# RigidLabeler â€“ è®¾è®¡æ€»è§ˆï¼ˆDesign Overviewï¼‰

ç‰ˆæœ¬ï¼š`v0.1.0` (å·²å®ç°)

---

## 1. ç›®æ ‡ä¸èŒƒå›´ï¼ˆGoal & Scopeï¼‰

RigidLabeler æ˜¯ä¸€ä¸ªè½»é‡çº§æ¡Œé¢å·¥å…·ï¼Œç”¨äºç»™ä¸€å¯¹äºŒç»´å›¾åƒä¹‹é—´çš„ **åˆšæ€§å˜æ¢ï¼ˆæˆ–ç›¸ä¼¼å˜æ¢ï¼‰æ‰“æ ‡ç­¾**ã€‚  

å…¸å‹ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š

- åœ¨ä¸¤å¼ å›¾åƒä¹‹é—´ï¼ˆä¾‹å¦‚ IRâ€“VISï¼‰**æ‰‹åŠ¨æ ‡æ³¨å¯¹åº”ç‚¹ï¼ˆtie pointsï¼‰**ï¼›
- åŸºäºè¿™äº›ç‚¹å¯¹ï¼Œè®¡ç®— 2D åˆšæ€§/ç›¸ä¼¼å˜æ¢å‚æ•°ï¼š
  - æ—‹è½¬è§’ `Î¸`
  - å¹³ç§» `(tx, ty)`
  - å¯é€‰ç»Ÿä¸€ç¼©æ”¾ `s`
- å°†è¿™äº›å‚æ•°ï¼ˆä»¥åŠçŸ©é˜µä¸ç‚¹å¯¹ï¼‰å¯¼å‡ºä¸ºæ ‡ç­¾ï¼Œç”¨äºï¼š
  - æ·±åº¦å­¦ä¹ è®­ç»ƒæ•°æ®æ ‡æ³¨
  - ç®—æ³•è¯„ä¼°ä¸å®šé‡å¯¹æ¯”
  - è‡ªå»ºé…å‡†æ•°æ®é›†ç®¡ç†

æœ¬ç‰ˆæœ¬ï¼ˆv0.1.0ï¼‰çš„èŒƒå›´ï¼š

- å•æœºã€æœ¬åœ°ä½¿ç”¨çš„æ¡Œé¢å·¥å…·ï¼ˆæ— å¤šç”¨æˆ·/æƒé™ç­‰å¤æ‚éœ€æ±‚ï¼‰ï¼›
- å‰ç«¯ä½¿ç”¨ **Qt C++** å®ç°æ¡Œé¢ GUIï¼ˆQt 6.xï¼Œä½¿ç”¨ .ui æ–‡ä»¶è¿›è¡Œ UI è®¾è®¡ï¼‰ï¼›
- åç«¯ä½¿ç”¨ **FastAPI** æä¾›æœ¬åœ° HTTP JSON æœåŠ¡ï¼Œåœ¨ `localhost:8000` ä¸Šè¿è¡Œã€‚

---

## 2. æ•´ä½“æ¶æ„ï¼ˆHigh-Level Architectureï¼‰

RigidLabeler é‡‡ç”¨ä¸€ä¸ªéå¸¸ç®€å•çš„ **ä¸¤å±‚æ¶æ„**ï¼š

```text
+----------------------------+        HTTP / JSON       +----------------------------+
|        Qt å‰ç«¯ï¼ˆGUIï¼‰      |  <-------------------->  |      FastAPI åç«¯æœåŠ¡       |
|                            |                          |                            |
|  - MainWindow (.ui)        |                          |  - GET  /health            |
|  - å›º/åŠ¨å›¾åƒè§†å›¾           |                          |  - POST /compute/rigid     |
|  - Tie Point è¡¨æ ¼          |                          |  - POST /labels/save       |
|  - å·¥å…·æ  / çŠ¶æ€æ          |                          |  - POST /labels/load       |
|  - BackendClient (HTTP)    |                          |  - GET  /labels/list       |
+----------------------------+                          |  - POST /warp/preview      |
                                                        +----------------------------+
```

### 2.1 å‰ç«¯èŒè´£ï¼ˆQtï¼‰

å‰ç«¯ä¸»è¦è´Ÿè´£ï¼š

* åŠ è½½å’Œæ˜¾ç¤ºä¸€å¯¹å›¾åƒï¼ˆå›ºå®šå›¾ / ç§»åŠ¨å›¾ï¼‰ï¼›
* äº¤äº’å¼åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ **å¯¹åº”ç‚¹ï¼ˆtie pointsï¼‰**ï¼›
* è°ƒç”¨åç«¯ HTTP æ¥å£ï¼š
  * è®¡ç®—åˆšæ€§å˜æ¢ï¼›
  * ä¿å­˜ / åŠ è½½æ ‡ç­¾ï¼›
  * ï¼ˆå¯é€‰ï¼‰ç”Ÿæˆ warp é¢„è§ˆå›¾ï¼›
* ç»´æŠ¤å½“å‰ä¼šè¯çš„å†…å­˜çŠ¶æ€ï¼š
  * å½“å‰å›¾åƒå¯¹ï¼›
  * å½“å‰ç‚¹å¯¹åˆ—è¡¨ï¼›
  * å½“å‰å˜æ¢å‚æ•°ä¸æ ‡ç­¾ä¿¡æ¯ã€‚

### 2.2 åç«¯èŒè´£ï¼ˆFastAPIï¼‰

åç«¯ä¸»è¦è´Ÿè´£ï¼š

* æä¾›ä¸€ç»„å¹²å‡€çš„ HTTP/JSON æ¥å£ï¼ˆFastAPIï¼‰ï¼›
* å®ç°åˆšæ€§å˜æ¢çš„æ•°å€¼è®¡ç®—é€»è¾‘ï¼›
* è®¡ç®—å˜æ¢çŸ©é˜µä¸è¯¯å·®æŒ‡æ ‡ï¼›
* å°†æ ‡ç­¾æŒä¹…åŒ–ï¼ˆJSONï¼‰åˆ°ç£ç›˜ï¼›
* ï¼ˆå¯é€‰ï¼‰åˆ©ç”¨å›¾åƒåº“ï¼ˆOpenCVï¼‰ç”Ÿæˆ warp é¢„è§ˆå›¾ã€‚

---

## 3. å®ç°çŠ¶æ€ï¼ˆImplementation Statusï¼‰

### âœ… å·²å®ç°åŠŸèƒ½

#### å‰ç«¯ (Qt C++)

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| MainWindow UI | âœ… | ä½¿ç”¨ `mainwindow.ui` æ–‡ä»¶å®šä¹‰ç•Œé¢å¸ƒå±€ |
| å›¾åƒåŠ è½½æ˜¾ç¤º | âœ… | æ”¯æŒ PNG/JPG/BMP/TIFF ç­‰æ ¼å¼ |
| åŒè§†å›¾ (Fixed/Moving) | âœ… | ä½¿ç”¨ QGraphicsView + QGraphicsScene |
| è§†å›¾è”åŠ¨ç¼©æ”¾/å¹³ç§» | âœ… | æ”¯æŒåŒæ­¥å’Œç‹¬ç«‹æ¨¡å¼ |
| Tie Point æ·»åŠ  | âœ… | ç‚¹å‡»æ¨¡å¼æ·»åŠ ç‚¹å¯¹ |
| Tie Point è¡¨æ ¼æ˜¾ç¤º | âœ… | ä½¿ç”¨ QTableView + TiePointModel |
| Tie Point åˆ é™¤/æ¸…ç©º | âœ… | æ”¯æŒå•ä¸ªåˆ é™¤å’Œå…¨éƒ¨æ¸…ç©º |
| åç«¯é€šä¿¡ | âœ… | BackendClient å°è£… HTTP è¯·æ±‚ |
| é…ç½®ç®¡ç† | âœ… | AppConfig è¯»å– app.yaml |
| å˜æ¢ç»“æœæ˜¾ç¤º | âœ… | æ˜¾ç¤º Î¸, tx, ty, scale, RMS, çŸ©é˜µ |

#### åç«¯ (FastAPI + Python)

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| å¥åº·æ£€æŸ¥ `/health` | âœ… | è¿”å›ç‰ˆæœ¬ä¿¡æ¯ |
| åˆšæ€§å˜æ¢è®¡ç®— `/compute/rigid` | âœ… | SVD-based Procrustes åˆ†æ |
| æ ‡ç­¾ä¿å­˜ `/labels/save` | âœ… | JSON æ ¼å¼æŒä¹…åŒ– |
| æ ‡ç­¾åŠ è½½ `/labels/load` | âœ… | æ ¹æ®å›¾åƒå¯¹åŠ è½½ |
| æ ‡ç­¾åˆ—è¡¨ `/labels/list` | âœ… | åˆ—å‡ºæ‰€æœ‰å·²ä¿å­˜æ ‡ç­¾ |
| Warp é¢„è§ˆ `/warp/preview` | âœ… | OpenCV warpAffine |
| é…ç½®ç®¡ç† | âœ… | è¯»å– backend.yaml |
| å•å…ƒæµ‹è¯• | âœ… | transforms, label_store, api |
| ç‹¬ç«‹è·¯å¾„è®°å¿† | âœ… | Fixed/Moving å›¾åƒç›®å½•åˆ†åˆ«ç¼“å­˜ |
| å›¾åƒå¯¼èˆª | âœ… | Next Fixed / Next Moving / Next Pair |
| GT æ–‡ä»¶å¤¹å¯¼å‡º | âœ… | å¯¼å‡º 3Ã—3 çŸ©é˜µåˆ°ç¼–å· txt æ–‡ä»¶ |
| å¢å¼ºé¼ æ ‡äº¤äº’ | âœ… | Ctrl+æ‹–åŠ¨å¹³ç§»ã€Shift+æ‹–åŠ¨æ¡†é€‰ |
| ç‚¹å‡»é€‰ç‚¹ | âœ… | ç‚¹å‡»æ ‡è®°ç‚¹ç›´æ¥é€‰ä¸­ |
| æ’¤é”€/é‡åš | âœ… | QUndoStack æ”¯æŒ Ctrl+Z/Ctrl+Y |

### ğŸ”² å¾…å®ç°åŠŸèƒ½

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|-----|-------|------|
| Warp é¢„è§ˆ UI é›†æˆ | é«˜ | å‰ç«¯è°ƒç”¨ /warp/preview å¹¶æ˜¾ç¤º |
| å åŠ æ˜¾ç¤ºæ¨¡å¼ | ä¸­ | é€æ˜åº¦è°ƒèŠ‚çš„å›¾åƒå åŠ  |
| è·¨å¹³å°æ‰“åŒ… | ä½ | Windows/Linux/macOS åˆ†å‘ |

---

## 4. é¡¹ç›®ç»“æ„ï¼ˆProject Structureï¼‰

```text
RigidLabeler/
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ start_backend.bat          # Windows å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_backend.ps1          # PowerShell å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ app.yaml               # å‰ç«¯é…ç½®
â”‚   â””â”€â”€ backend.yaml           # åç«¯é…ç½®
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ images/                # å›¾åƒç›®å½•
â”‚   â”œâ”€â”€ labels/                # æ ‡ç­¾è¾“å‡ºç›®å½•
â”‚   â””â”€â”€ temp/                  # ä¸´æ—¶æ–‡ä»¶
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ design_overview.md     # æœ¬æ–‡æ¡£
â”‚   â”œâ”€â”€ api_spec.md            # API è§„èŒƒ
â”‚   â”œâ”€â”€ config_spec.md         # é…ç½®è§„èŒƒ
â”‚   â””â”€â”€ label_format.md        # æ ‡ç­¾æ ¼å¼è§„èŒƒ
â”‚
â”œâ”€â”€ frontend/                  # Qt C++ å‰ç«¯
â”‚   â”œâ”€â”€ frontend.pro           # Qt é¡¹ç›®æ–‡ä»¶
â”‚   â”œâ”€â”€ main.cpp
â”‚   â”œâ”€â”€ mainwindow.h
â”‚   â”œâ”€â”€ mainwindow.cpp
â”‚   â”œâ”€â”€ mainwindow.ui          # â­ Qt Designer UI æ–‡ä»¶
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ AppConfig.h/cpp    # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ BackendClient.h/cpp # HTTP å®¢æˆ·ç«¯
â”‚   â””â”€â”€ model/
â”‚       â”œâ”€â”€ ImagePairModel.h/cpp
â”‚       â””â”€â”€ TiePointModel.h/cpp
â”‚
â””â”€â”€ backend/                   # Python åç«¯
    â”œâ”€â”€ requirements.txt
    â”œâ”€â”€ scripts/
    â”‚   â””â”€â”€ run_server.py
    â””â”€â”€ rigidlabeler_backend/
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ config.py
        â”œâ”€â”€ api/
        â”‚   â”œâ”€â”€ server.py      # FastAPI å…¥å£
        â”‚   â””â”€â”€ schemas.py     # Pydantic æ¨¡å‹
        â”œâ”€â”€ core/
        â”‚   â””â”€â”€ transforms.py  # SVD åˆšæ€§å˜æ¢
        â”œâ”€â”€ io/
        â”‚   â”œâ”€â”€ image_loader.py
        â”‚   â””â”€â”€ label_store.py
        â”œâ”€â”€ utils/
        â”‚   â”œâ”€â”€ logging_utils.py
        â”‚   â””â”€â”€ path_utils.py
        â””â”€â”€ tests/
            â”œâ”€â”€ test_transforms.py
            â”œâ”€â”€ test_label_store.py
            â””â”€â”€ test_api.py
```

---

## 5. æ ¸å¿ƒç®—æ³•ï¼ˆCore Algorithmï¼‰

### 5.1 åˆšæ€§å˜æ¢ä¼°è®¡ï¼ˆProcrustes Analysisï¼‰

ç®—æ³•æµç¨‹ï¼ˆå®ç°äº `core/transforms.py`ï¼‰ï¼š

1. **è´¨å¿ƒè®¡ç®—**
   - è®¡ç®— fixed ç‚¹é›†è´¨å¿ƒ $\mu_f$
   - è®¡ç®— moving ç‚¹é›†è´¨å¿ƒ $\mu_m$

2. **ä¸­å¿ƒåŒ–**
   - $P_f = \text{fixed points} - \mu_f$
   - $P_m = \text{moving points} - \mu_m$

3. **SVD åˆ†è§£**
   - è®¡ç®—åæ–¹å·®çŸ©é˜µ $H = P_m^T \cdot P_f$
   - SVD åˆ†è§£ï¼š$H = U \Sigma V^T$
   - æ—‹è½¬çŸ©é˜µï¼š$R = V \cdot U^T$
   - ç¡®ä¿ $\det(R) = +1$ï¼ˆé¿å…åå°„ï¼‰

4. **ç¼©æ”¾è®¡ç®—**ï¼ˆå¯é€‰ï¼‰
   - è‹¥ `allow_scale = true`ï¼š
   - $s = \frac{\text{trace}(\Sigma)}{\|P_m\|_F^2}$

5. **å¹³ç§»è®¡ç®—**
   - $t = \mu_f - s \cdot R \cdot \mu_m$

6. **è¾“å‡º**
   - æ—‹è½¬è§’ $\theta = \arctan2(R_{21}, R_{11})$
   - å¹³ç§» $(t_x, t_y)$
   - ç¼©æ”¾ $s$
   - 3Ã—3 é½æ¬¡å˜æ¢çŸ©é˜µ

### 5.2 RMS è¯¯å·®è®¡ç®—

$$\text{RMS} = \sqrt{\frac{1}{N} \sum_{i=1}^{N} \|p_f^{(i)} - T(p_m^{(i)})\|^2}$$

---

## 6. æ•°æ®æ¨¡å‹ï¼ˆData Modelsï¼‰

### 6.1 Pydantic Schemas (åç«¯)

```python
class Point2D(BaseModel):
    x: float
    y: float

class TiePoint(BaseModel):
    fixed: Point2D
    moving: Point2D

class RigidParams(BaseModel):
    theta_deg: float
    tx: float
    ty: float
    scale: float = 1.0

class Label(BaseModel):
    version: str = "1.0"
    image_fixed: str
    image_moving: str
    rigid: RigidParams
    matrix_3x3: List[List[float]]
    tie_points: List[TiePoint]
    timestamp: Optional[str]
    comment: Optional[str]
```

### 6.2 Qt æ•°æ®ç»“æ„ (å‰ç«¯)

```cpp
struct TiePoint {
    QPointF fixed;
    QPointF moving;
};

struct RigidParams {
    double theta_deg;
    double tx, ty;
    double scale;
};

// TiePointModel: QAbstractTableModel
// ImagePairModel: QObject with QImage members
```

---

## 7. UI è®¾è®¡ï¼ˆUser Interfaceï¼‰

### 7.1 ä¸»çª—å£å¸ƒå±€ (mainwindow.ui)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Menu Bar: File | Edit | View | Help                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tool Bar: [Load Fixed] [Load Moving] | [Save] [Load] | [Zoom] [Fit] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                   â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Fixed Image View       â”‚  â”‚  â”‚    Moving Image View      â”‚  â”‚
â”‚  â”‚      (QGraphicsView)        â”‚  â”‚  â”‚    (QGraphicsView)        â”‚  â”‚
â”‚  â”‚                             â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚                             â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [Load Fixed] [Fit] X:-, Y:-      â”‚  [Load Moving] [Fit] X:-, Y:-   â”‚
â”‚                                   â”‚                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Tie Points Table                                                 â”‚â”‚
â”‚  â”‚ # | Fixed X | Fixed Y | Moving X | Moving Y                     â”‚â”‚
â”‚  â”‚ 1 | 100.00  | 200.00  | 110.00   | 195.00                       â”‚â”‚
â”‚  â”‚ 2 | 300.00  | 150.00  | 315.00   | 140.00                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  [Add Point] [Delete] [Clear All]  Points: 2 (min 2 required)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Options: â˜‘ Allow Scale  â˜‘ Sync Zoom  â˜ Show Overlay  Opacity: 50% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Actions: [Compute Transform] [Save Label] [Load Label] [Preview]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Transform Result:                                                   â”‚
â”‚  Rotation: 5.3000Â°                                                   â”‚
â”‚  Translation: (12.4000, -3.1000)                                     â”‚
â”‚  Scale: 1.000000                                                     â”‚
â”‚  RMS Error: 0.8200 px                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status Bar: Backend: Online (v1.0) | Points: 2 | Zoom: 100%         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ |
|-------|------|
| Ctrl+1 | åŠ è½½ Fixed å›¾åƒ |
| Ctrl+2 | åŠ è½½ Moving å›¾åƒ |
| Ctrl+S | ä¿å­˜æ ‡ç­¾ |
| Ctrl+O | åŠ è½½æ ‡ç­¾ |
| Ctrl+R | è®¡ç®—å˜æ¢ |
| Ctrl++ | æ”¾å¤§ |
| Ctrl+- | ç¼©å° |
| Ctrl+0 | é€‚åº”çª—å£ |
| Ctrl+Z | æ’¤é”€ï¼ˆå¾…å®ç°ï¼‰ |
| Ctrl+Y | é‡åšï¼ˆå¾…å®ç°ï¼‰ |

---

## 8. é…ç½®æ–‡ä»¶

### 8.1 backend.yaml

```yaml
server:
  host: "127.0.0.1"
  port: 8000

paths:
  labels_root: "data/labels"
  temp_root: "data/temp"

transform:
  default_allow_scale: false
  min_points_required: 2
```

### 8.2 app.yaml

```yaml
backend:
  base_url: "http://127.0.0.1:8000"

paths:
  default_images_root: "data/images"
  default_labels_root: "data/labels"

ui:
  language: "zh_CN"
  theme: "default"
  link_views_by_default: true
  remember_last_dir: true

transform:
  allow_scale_default: false
  min_points_required: 2
```

---

## 9. æµ‹è¯•ç­–ç•¥

### 9.1 å•å…ƒæµ‹è¯•

- `test_transforms.py`: éªŒè¯ SVD åˆšæ€§å˜æ¢è®¡ç®—æ­£ç¡®æ€§
- `test_label_store.py`: éªŒè¯æ ‡ç­¾ä¿å­˜/åŠ è½½ä¸€è‡´æ€§
- `test_api.py`: ä½¿ç”¨ TestClient æµ‹è¯• API ç«¯ç‚¹

### 9.2 è¿è¡Œæµ‹è¯•

```bash
cd backend
pytest rigidlabeler_backend/tests/ -v
```

---

## 10. éƒ¨ç½²è¯´æ˜

### 10.1 åç«¯å¯åŠ¨

```bash
# å®‰è£…ä¾èµ–
pip install -r backend/requirements.txt

# å¯åŠ¨æœåŠ¡
python backend/scripts/run_server.py

# æˆ–ä½¿ç”¨è„šæœ¬
./start_backend.ps1  # PowerShell
./start_backend.bat  # Windows CMD
```

### 10.2 å‰ç«¯æ„å»º

```bash
# Qt Creator
æ‰“å¼€ frontend/frontend.pro

# å‘½ä»¤è¡Œ
cd frontend
qmake frontend.pro
make  # æˆ– mingw32-make (Windows)
```

---

## 11. æœªæ¥æ‰©å±•

1. **æ›´å¤šå˜æ¢ç±»å‹**
   - ä»¿å°„å˜æ¢ (6 DoF)
   - å•åº”å˜æ¢ (8 DoF)

2. **æ‰¹é‡å¤„ç†**
   - å¤šå›¾åƒå¯¹é˜Ÿåˆ—
   - æ‰¹é‡å¯¼å‡º

3. **æ·±åº¦å­¦ä¹ é›†æˆ**
   - è‡ªåŠ¨ç‰¹å¾ç‚¹æ£€æµ‹
   - å˜æ¢å‚æ•°é¢„æµ‹

4. **å·¥ç¨‹ç®¡ç†**
   - é¡¹ç›®æ–‡ä»¶æ ¼å¼
   - æ ‡æ³¨è¿›åº¦è¿½è¸ª
